---
import '../styles/global.css';
import WhatsAppIcon from '../components/WhatsAppIcon.astro';

export interface Props {
  title: string;
  description?: string;
}

const { title, description = 'CrediGestor - Créditos de libranza para pensionados, maestros y policías' } = Astro.props;
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Favicon optimizado para mejor rendimiento y compatibilidad -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/svg+xml" href="/credigestor.svg" sizes="any" />
    <link rel="apple-touch-icon" href="/credigestor.svg" />
    <meta name="theme-color" content="#d3bc5f" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Performance optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://media.tecnochat.com" />
    
    <!-- SEO Meta Tags -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/header.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content="/header.jpg" />
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/credigestor.svg" as="image" type="image/svg+xml" />
    <link rel="preload" href="/header.avif" as="image" type="image/avif" />
    <link rel="preload" href="../styles/global.css" as="style" />
    
    <title>{title}</title>
    
    <style is:global>
      /* Dark theme adjustments */
      .bg-white {
        background-color: rgba(255, 255, 255, 0.1) !important;
        backdrop-filter: blur(10px);
      }
      
      .text-gray-900 {
        color: var(--text-dark) !important;
      }
      
      .text-gray-600 {
        color: var(--text-light) !important;
      }
    </style>
  </head>
  <body class="font-sans antialiased">
    <slot />
    
    <!-- Performance optimization script -->
    <script>
      // Initialize performance optimizations
      document.addEventListener('DOMContentLoaded', function() {
        // Optimize animations for low-end devices
        const isLowEndDevice = navigator.hardwareConcurrency <= 2 || 
                              (navigator.deviceMemory && navigator.deviceMemory <= 2);
        
        if (isLowEndDevice) {
          document.documentElement.style.setProperty('--animation-duration', '0.2s');
          document.documentElement.style.setProperty('--transition-duration', '0.15s');
        }
        
        // Add touch-friendly classes for mobile devices
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                        window.innerWidth <= 768;
        
        if (isMobile) {
          document.body.classList.add('mobile-device');
        }
        
        // Optimize scroll performance
        let ticking = false;
        function updateScrollPosition() {
          // Throttle scroll events for better performance
          ticking = false;
        }
        
        window.addEventListener('scroll', function() {
          if (!ticking) {
            requestAnimationFrame(updateScrollPosition);
            ticking = true;
          }
        }, { passive: true });
      });
    </script>
    
    <!-- WhatsApp Float Button -->
    <a 
      href="https://wa.me/573505489828?text=Hola,%20necesito%20información%20sobre%20créditos%20de%20libranza" 
      target="_blank" 
      rel="noopener noreferrer"
      class="fixed bottom-6 right-6 z-50 bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110"
      aria-label="Contactar por WhatsApp"
    >
      <WhatsAppIcon class="w-6 h-6" />
    </a>
  </body>
</html>